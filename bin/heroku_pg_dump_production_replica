#!/bin/sh
rm -f ./tmp/production-shallow.dump

if [[ -z "$PRODUCTION_DATABASE_REPLICA_URL" ]]; then
  echo "PRODUCTION_DATABASE_REPLICA_URL environment variable not set!"
  exit 1
fi

pg_dump --verbose --no-acl --no-owner --format=c \
  --exclude-table=impressions_2018_11_advertiser_123 \
  --exclude-table=impressions_2018_11_advertiser_132 \
  --exclude-table=impressions_2018_11_advertiser_137 \
  --exclude-table=impressions_2018_11_advertiser_144 \
  --exclude-table=impressions_2018_11_advertiser_146 \
  --exclude-table=impressions_2018_11_advertiser_155 \
  --exclude-table=impressions_2018_11_advertiser_158 \
  --exclude-table=impressions_2018_11_advertiser_160 \
  --exclude-table=impressions_2018_11_advertiser_169 \
  --exclude-table=impressions_2018_11_advertiser_185 \
  --exclude-table=impressions_2018_12_advertiser_123 \
  --exclude-table=impressions_2018_12_advertiser_137 \
  --exclude-table=impressions_2018_12_advertiser_158 \
  --exclude-table=impressions_2018_12_advertiser_185 \
  --exclude-table=impressions_2019_01_advertiser_123 \
  --exclude-table=impressions_2019_01_advertiser_132 \
  --exclude-table=impressions_2019_01_advertiser_137 \
  --exclude-table=impressions_2019_01_advertiser_146 \
  --exclude-table=impressions_2019_01_advertiser_147 \
  --exclude-table=impressions_2019_01_advertiser_185 \
  --exclude-table=impressions_2019_01_advertiser_199 \
  --exclude-table=impressions_2019_01_advertiser_213 \
  --exclude-table=impressions_2019_01_advertiser_222 \
  --exclude-table=impressions_2019_02_advertiser_123 \
  --exclude-table=impressions_2019_02_advertiser_132 \
  --exclude-table=impressions_2019_02_advertiser_137 \
  --exclude-table=impressions_2019_02_advertiser_146 \
  --exclude-table=impressions_2019_02_advertiser_147 \
  --exclude-table=impressions_2019_02_advertiser_158 \
  --exclude-table=impressions_2019_02_advertiser_185 \
  --exclude-table=impressions_2019_02_advertiser_213 \
  --exclude-table=impressions_2019_02_advertiser_217 \
  --exclude-table=impressions_2019_02_advertiser_220 \
  --exclude-table=impressions_2019_02_advertiser_222 \
  --exclude-table=impressions_2019_02_advertiser_236 \
  --exclude-table=impressions_2019_02_advertiser_239 \
  --exclude-table=impressions_2019_02_advertiser_278 \
  --exclude-table=impressions_2019_03_advertiser_117 \
  --exclude-table=impressions_2019_03_advertiser_123 \
  --exclude-table=impressions_2019_03_advertiser_132 \
  --exclude-table=impressions_2019_03_advertiser_137 \
  --exclude-table=impressions_2019_03_advertiser_146 \
  --exclude-table=impressions_2019_03_advertiser_158 \
  --exclude-table=impressions_2019_03_advertiser_160 \
  --exclude-table=impressions_2019_03_advertiser_185 \
  --exclude-table=impressions_2019_03_advertiser_19 \
  --exclude-table=impressions_2019_03_advertiser_220 \
  --exclude-table=impressions_2019_03_advertiser_222 \
  --exclude-table=impressions_2019_03_advertiser_236 \
  --exclude-table=impressions_2019_03_advertiser_239 \
  --exclude-table=impressions_2019_03_advertiser_267 \
  --exclude-table=impressions_2019_03_advertiser_278 \
  --exclude-table=impressions_2019_03_advertiser_383 \
  --exclude-table=impressions_2019_04_advertiser_117 \
  --exclude-table=impressions_2019_04_advertiser_123 \
  --exclude-table=impressions_2019_04_advertiser_132 \
  --exclude-table=impressions_2019_04_advertiser_137 \
  --exclude-table=impressions_2019_04_advertiser_146 \
  --exclude-table=impressions_2019_04_advertiser_160 \
  --exclude-table=impressions_2019_04_advertiser_185 \
  --exclude-table=impressions_2019_04_advertiser_19 \
  --exclude-table=impressions_2019_04_advertiser_220 \
  --exclude-table=impressions_2019_04_advertiser_222 \
  --exclude-table=impressions_2019_04_advertiser_239 \
  --exclude-table=impressions_2019_04_advertiser_267 \
  --exclude-table=impressions_2019_04_advertiser_272 \
  --exclude-table=impressions_2019_04_advertiser_305 \
  --exclude-table=impressions_2019_04_advertiser_349 \
  --exclude-table=impressions_2019_04_advertiser_365 \
  --exclude-table=impressions_2019_04_advertiser_378 \
  --exclude-table=impressions_2019_04_advertiser_381 \
  --exclude-table=impressions_2019_04_advertiser_383 \
  --exclude-table=impressions_2019_04_advertiser_385 \
  --exclude-table=impressions_2019_04_advertiser_387 \
  --exclude-table=impressions_2019_04_advertiser_390 \
  --exclude-table=impressions_2019_04_advertiser_435 \
  --exclude-table=impressions_2019_04_advertiser_453 \
  --exclude-table=impressions_2019_04_advertiser_468 \
  --exclude-table=impressions_2019_04_advertiser_471 \
  --exclude-table=impressions_2019_04_advertiser_96 \
  --exclude-table=impressions_2019_05_advertiser_123 \
  --exclude-table=impressions_2019_05_advertiser_132 \
  --exclude-table=impressions_2019_05_advertiser_146 \
  --exclude-table=impressions_2019_05_advertiser_147 \
  --exclude-table=impressions_2019_05_advertiser_160 \
  --exclude-table=impressions_2019_05_advertiser_185 \
  --exclude-table=impressions_2019_05_advertiser_220 \
  --exclude-table=impressions_2019_05_advertiser_222 \
  --exclude-table=impressions_2019_05_advertiser_239 \
  --exclude-table=impressions_2019_05_advertiser_272 \
  --exclude-table=impressions_2019_05_advertiser_305 \
  --exclude-table=impressions_2019_05_advertiser_349 \
  --exclude-table=impressions_2019_05_advertiser_365 \
  --exclude-table=impressions_2019_05_advertiser_381 \
  --exclude-table=impressions_2019_05_advertiser_385 \
  --exclude-table=impressions_2019_05_advertiser_387 \
  --exclude-table=impressions_2019_05_advertiser_390 \
  --exclude-table=impressions_2019_05_advertiser_453 \
  --exclude-table=impressions_2019_05_advertiser_468 \
  --exclude-table=impressions_2019_05_advertiser_471 \
  --exclude-table=impressions_2019_05_advertiser_508 \
  --exclude-table=impressions_2019_05_advertiser_529 \
  --exclude-table=impressions_2019_05_advertiser_534 \
  --exclude-table=impressions_2019_05_advertiser_96 \
  --exclude-table=impressions_2019_06_advertiser_123 \
  --exclude-table=impressions_2019_06_advertiser_132 \
  --exclude-table=impressions_2019_06_advertiser_146 \
  --exclude-table=impressions_2019_06_advertiser_147 \
  --exclude-table=impressions_2019_06_advertiser_160 \
  --exclude-table=impressions_2019_06_advertiser_185 \
  --exclude-table=impressions_2019_06_advertiser_220 \
  --exclude-table=impressions_2019_06_advertiser_222 \
  --exclude-table=impressions_2019_06_advertiser_239 \
  --exclude-table=impressions_2019_06_advertiser_305 \
  --exclude-table=impressions_2019_06_advertiser_365 \
  --exclude-table=impressions_2019_06_advertiser_387 \
  --exclude-table=impressions_2019_06_advertiser_390 \
  --exclude-table=impressions_2019_06_advertiser_460 \
  --exclude-table=impressions_2019_06_advertiser_471 \
  --exclude-table=impressions_2019_06_advertiser_498 \
  --exclude-table=impressions_2019_06_advertiser_514 \
  --exclude-table=impressions_2019_06_advertiser_515 \
  --exclude-table=impressions_2019_06_advertiser_534 \
  --exclude-table=impressions_2019_06_advertiser_572 \
  --exclude-table=impressions_2019_06_advertiser_576 \
  --exclude-table=impressions_2019_06_advertiser_578 \
  --exclude-table=impressions_2019_06_advertiser_592 \
  --exclude-table=impressions_2019_06_advertiser_593 \
  --exclude-table=impressions_2019_07_advertiser_123 \
  --exclude-table=impressions_2019_07_advertiser_132 \
  --exclude-table=impressions_2019_07_advertiser_146 \
  --exclude-table=impressions_2019_07_advertiser_147 \
  --exclude-table=impressions_2019_07_advertiser_185 \
  --exclude-table=impressions_2019_07_advertiser_199 \
  --exclude-table=impressions_2019_07_advertiser_220 \
  --exclude-table=impressions_2019_07_advertiser_239 \
  --exclude-table=impressions_2019_07_advertiser_305 \
  --exclude-table=impressions_2019_07_advertiser_365 \
  --exclude-table=impressions_2019_07_advertiser_387 \
  --exclude-table=impressions_2019_07_advertiser_460 \
  --exclude-table=impressions_2019_07_advertiser_468 \
  --exclude-table=impressions_2019_07_advertiser_514 \
  --exclude-table=impressions_2019_07_advertiser_515 \
  --exclude-table=impressions_2019_07_advertiser_572 \
  --exclude-table=impressions_2019_07_advertiser_576 \
  --exclude-table=impressions_2019_07_advertiser_578 \
  --exclude-table=impressions_2019_07_advertiser_592 \
  --exclude-table=impressions_2019_07_advertiser_601 \
  --exclude-table=impressions_2019_07_advertiser_609 \
  --exclude-table=impressions_2019_07_advertiser_612 \
  --exclude-table=impressions_2019_07_advertiser_619 \
  --exclude-table=impressions_2019_07_advertiser_624 \
  --exclude-table=impressions_2019_07_advertiser_625 \
  --exclude-table=impressions_2019_08_advertiser_123 \
  --exclude-table=impressions_2019_08_advertiser_132 \
  --exclude-table=impressions_2019_08_advertiser_146 \
  --exclude-table=impressions_2019_08_advertiser_147 \
  --exclude-table=impressions_2019_08_advertiser_185 \
  --exclude-table=impressions_2019_08_advertiser_199 \
  --exclude-table=impressions_2019_08_advertiser_239 \
  --exclude-table=impressions_2019_08_advertiser_305 \
  --exclude-table=impressions_2019_08_advertiser_365 \
  --exclude-table=impressions_2019_08_advertiser_387 \
  --exclude-table=impressions_2019_08_advertiser_468 \
  --exclude-table=impressions_2019_08_advertiser_576 \
  --exclude-table=impressions_2019_08_advertiser_578 \
  --exclude-table=impressions_2019_08_advertiser_592 \
  --exclude-table=impressions_2019_08_advertiser_601 \
  --exclude-table=impressions_2019_08_advertiser_612 \
  --exclude-table=impressions_2019_08_advertiser_613 \
  --exclude-table=impressions_2019_08_advertiser_624 \
  --exclude-table=impressions_2019_08_advertiser_628 \
  --exclude-table=impressions_2019_08_advertiser_632 \
  --exclude-table=impressions_2019_08_advertiser_645 \
  --exclude-table=impressions_2019_08_advertiser_648 \
  --exclude-table=impressions_2019_08_advertiser_656 \
  --exclude-table=impressions_2019_08_advertiser_660 \
  --exclude-table=impressions_default \
  $PRODUCTION_DATABASE_REPLICA_URL > ./tmp/production-shallow.dump
